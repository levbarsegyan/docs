import path from 'path';
import { TEXTFIELD_EXT, FACET_EXT } from '../schema/ext.js';
import { ID_TYPE, ATTR_TYPE, FACET_TYPE } from '../schema/types.js';
import { AND } from '../schema/utils.js';

module.exports = {
  sfsId: process.env.SFS_ID || 'oecd',
  gitHash: process.env.GIT_HASH || '#develop',
  env: process.env.NODE_ENV,
  apiKey: process.env.API_KEY || 'secret',
  fields: {
    id: {
      type: ID_TYPE,
      out: true,
    },
    name: {
      type: ATTR_TYPE,
      ext: TEXTFIELD_EXT,
      search: true,
      out: true,
      highlight: true,
      localized: true,
    },
    description: {
      type: ATTR_TYPE,
      ext: TEXTFIELD_EXT,
      search: true,
      out: true,
      highlight: true,
      localized: true,
    },
  },
  dataflows: {
    defaultLocale: 'en',
    locales: ['en', 'fr'],
    outFields: [
      'id',
      'agency',
      'version',
      'name',
      'description',
      'frequency',
      'reference_area',
      'interest_rate_type',
      'score',
      'category',
    ],
    searchFields: ['name', 'description'],
    highlighting: {
      fields: ['name', 'description'],
    },
    schema: [
      {
        name: 'name',
        field: lang => `name_${lang}_txt`,
      },
      {
        name: 'description',
        field: lang => `description_${lang}_txt`,
      },

      {
        name: 'agency',
        field: 'agency_s',
      },
      {
        name: 'version',
        field: 'version_s',
      },
      {
        ID: 'REF_AREA',
        name: 'reference_area',
        field: 'reference_area_ss',
      },
      {
        ID: 'IR_TYPE',
        name: 'interest_rate_type',
        field: 'interest_rate_type_ss',
      },
      {
        ID: 'FREQ',
        name: 'frequency',
        field: lang => `frequency_${lang}_ss`,
      },
      {
        ID: 'CATEGORY',
        name: 'category',
        field: 'category_ss',
      },
    ],
    facets: [
      {
        name: 'reference_area',
        type: 'dimension',
        op: 'OR',
      },
      {
        name: 'interest_rate_type',
        type: 'dimension',
        op: 'OR',
      },
      {
        name: 'frequency',
        type: 'dimension',
        localized: true,
        op: 'OR',
      },
      {
        name: 'category',
        type: 'category',
      },
    ],
  },
};
